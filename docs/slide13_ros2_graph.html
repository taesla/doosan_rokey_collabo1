<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Slide 13: ROS2 Integration Graph</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap">
    <style>
        body { font-family: 'Noto Sans KR', sans-serif; margin: 0; padding: 0; overflow: hidden; }
        .slide-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            background: #1e293b;
        }
        .slide {
            width: 1280px;
            height: 720px;
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            padding: 30px 40px;
            box-sizing: border-box;
            transform: scale(0.75);
            transform-origin: center center;
            color: white;
        }
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #3b82f6;
            padding-bottom: 10px;
        }
        .header h1 { font-size: 28px; font-weight: 900; }
        .header .badge { background: #3b82f6; padding: 5px 15px; border-radius: 20px; font-weight: 700; font-size: 14px; }

        /* Graph Container */
        .graph-container {
            display: flex;
            height: calc(100% - 60px);
            gap: 15px;
        }

        /* Main Graph Area */
        .main-graph {
            flex: 1;
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 15px;
            position: relative;
            overflow: hidden;
        }

        /* Node Styles */
        .node {
            position: absolute;
            border-radius: 10px;
            padding: 8px 12px;
            font-size: 11px;
            font-weight: 700;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3);
            z-index: 10;
        }
        .node-driver { background: linear-gradient(135deg, #ef4444, #dc2626); border: 2px solid #fca5a5; }
        .node-app { background: linear-gradient(135deg, #22c55e, #16a34a); border: 2px solid #86efac; }
        .node-interface { background: linear-gradient(135deg, #3b82f6, #2563eb); border: 2px solid #93c5fd; }
        .node-external { background: linear-gradient(135deg, #f59e0b, #d97706); border: 2px solid #fcd34d; }
        .node-watcher { background: linear-gradient(135deg, #8b5cf6, #7c3aed); border: 2px solid #c4b5fd; }

        .node-name { font-size: 12px; margin-bottom: 2px; }
        .node-pkg { font-size: 9px; opacity: 0.8; }

        /* Topic/Service Arrows with SVG */
        .connections {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            pointer-events: none;
        }
        .topic-line { stroke: #22d3ee; stroke-width: 2; fill: none; }
        .service-line { stroke: #f472b6; stroke-width: 2; stroke-dasharray: 5,3; fill: none; }

        /* Legend */
        .legend {
            width: 220px;
            background: rgba(255,255,255,0.05);
            border-radius: 12px;
            padding: 15px;
            font-size: 11px;
        }
        .legend-title { font-size: 14px; font-weight: 800; margin-bottom: 15px; color: #3b82f6; }
        .legend-section { margin-bottom: 15px; }
        .legend-section h4 { font-size: 11px; color: #94a3b8; margin-bottom: 8px; }
        .legend-item { display: flex; align-items: center; gap: 8px; margin-bottom: 5px; font-size: 10px; }
        .legend-color { width: 16px; height: 16px; border-radius: 4px; }
        .legend-line { width: 30px; height: 3px; border-radius: 2px; }
        .legend-line.topic { background: #22d3ee; }
        .legend-line.service { background: #f472b6; background: repeating-linear-gradient(90deg, #f472b6 0, #f472b6 5px, transparent 5px, transparent 8px); }

        /* Topic/Service Labels */
        .label {
            position: absolute;
            font-size: 8px;
            background: rgba(0,0,0,0.7);
            padding: 2px 5px;
            border-radius: 3px;
            white-space: nowrap;
            z-index: 5;
        }
        .label-topic { color: #22d3ee; border: 1px solid #22d3ee; }
        .label-service { color: #f472b6; border: 1px solid #f472b6; }

        /* Integration Message */
        .integration-msg {
            position: absolute;
            bottom: 15px;
            left: 50%;
            transform: translateX(-50%);
            background: linear-gradient(90deg, #3b82f6, #8b5cf6);
            padding: 8px 25px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            z-index: 20;
        }
    </style>
</head>
<body>
    <div class="slide-container">
    <div class="slide">
        <div class="header">
            <h1><i class="fas fa-project-diagram mr-3"></i>ROS2 통합 시스템 노드 그래프</h1>
            <span class="badge">rqt_graph Style</span>
        </div>

        <div class="graph-container">
            <div class="main-graph">
                <!-- SVG Connections -->
                <svg class="connections" viewBox="0 0 800 520">
                    <!-- Driver → Sort Node (Topics) -->
                    <path class="topic-line" d="M130,100 C200,100 200,180 270,180" marker-end="url(#arrow-topic)"/>
                    <!-- Sort Node → Driver (Services) -->
                    <path class="service-line" d="M270,200 C200,200 200,120 130,120" marker-end="url(#arrow-service)"/>
                    
                    <!-- Sort Node → Web Server (Topics) -->
                    <path class="topic-line" d="M370,180 L500,130" marker-end="url(#arrow-topic)"/>
                    <!-- Web Server → Sort Node (Services) -->
                    <path class="service-line" d="M500,150 L370,200" marker-end="url(#arrow-service)"/>
                    
                    <!-- Conveyor Bridge → Sort Node (Topics) -->
                    <path class="topic-line" d="M180,380 C250,380 250,220 270,220" marker-end="url(#arrow-topic)"/>
                    <!-- Sort Node → Conveyor Bridge (Topics) -->
                    <path class="topic-line" d="M270,240 C250,300 200,350 180,400" marker-end="url(#arrow-topic)"/>
                    
                    <!-- Web Server → Browser (WebSocket) -->
                    <path class="topic-line" d="M620,140 L720,100" marker-end="url(#arrow-topic)"/>
                    <path class="topic-line" d="M720,120 L620,160" marker-end="url(#arrow-topic)"/>
                    
                    <!-- Web Server → Firebase -->
                    <path class="topic-line" d="M620,170 L720,220" marker-end="url(#arrow-topic)"/>
                    
                    <!-- Watcher → Launch System -->
                    <path class="service-line" d="M580,350 C500,350 400,300 350,250" marker-end="url(#arrow-service)"/>
                    <!-- Watcher → Driver Check -->
                    <path class="service-line" d="M580,330 C400,300 200,200 130,140" marker-end="url(#arrow-service)"/>
                    
                    <!-- Sort Node → Watcher Status -->
                    <path class="topic-line" d="M370,220 C450,280 520,310 580,310" marker-end="url(#arrow-topic)"/>

                    <!-- Arrow Markers -->
                    <defs>
                        <marker id="arrow-topic" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
                            <polygon points="0 0, 6 3, 0 6" fill="#22d3ee"/>
                        </marker>
                        <marker id="arrow-service" markerWidth="6" markerHeight="6" refX="5" refY="3" orient="auto">
                            <polygon points="0 0, 6 3, 0 6" fill="#f472b6"/>
                        </marker>
                    </defs>
                </svg>

                <!-- NODES -->
                <!-- DSR Driver Node -->
                <div class="node node-driver" style="left: 30px; top: 80px; width: 100px;">
                    <div class="node-name"><i class="fas fa-microchip mr-1"></i>DSR Driver</div>
                    <div class="node-pkg">dsr_bringup2</div>
                </div>

                <!-- Sort Node -->
                <div class="node node-app" style="left: 270px; top: 160px; width: 100px;">
                    <div class="node-name"><i class="fas fa-robot mr-1"></i>Sort Node</div>
                    <div class="node-pkg">dsr_integrated</div>
                </div>

                <!-- Web Server Node -->
                <div class="node node-interface" style="left: 500px; top: 110px; width: 120px;">
                    <div class="node-name"><i class="fas fa-server mr-1"></i>Web Server</div>
                    <div class="node-pkg">Flask + SocketIO</div>
                </div>

                <!-- Conveyor Bridge -->
                <div class="node node-interface" style="left: 50px; top: 360px; width: 130px;">
                    <div class="node-name"><i class="fas fa-exchange-alt mr-1"></i>Conveyor Bridge</div>
                    <div class="node-pkg">arduino_conveyor_bridge</div>
                </div>

                <!-- Watcher Node -->
                <div class="node node-watcher" style="left: 580px; top: 290px; width: 120px;">
                    <div class="node-name"><i class="fas fa-eye mr-1"></i>Watcher Node</div>
                    <div class="node-pkg">dsr_recovery_watcher</div>
                </div>

                <!-- External: Browser -->
                <div class="node node-external" style="left: 700px; top: 80px; width: 80px;">
                    <div class="node-name"><i class="fas fa-globe mr-1"></i>Browser</div>
                    <div class="node-pkg">WebSocket</div>
                </div>

                <!-- External: Firebase -->
                <div class="node node-external" style="left: 700px; top: 200px; width: 80px;">
                    <div class="node-name"><i class="fas fa-fire mr-1"></i>Firebase</div>
                    <div class="node-pkg">RTDB</div>
                </div>

                <!-- External: Arduino -->
                <div class="node node-external" style="left: 50px; top: 450px; width: 80px;">
                    <div class="node-name"><i class="fas fa-microchip mr-1"></i>Arduino</div>
                    <div class="node-pkg">Serial</div>
                </div>

                <!-- Topic/Service Labels -->
                <div class="label label-topic" style="left: 150px; top: 80px;">/dsr01/joint_states</div>
                <div class="label label-service" style="left: 150px; top: 130px;">/dsr01/motion/*</div>
                <div class="label label-topic" style="left: 400px; top: 135px;">/dlar/status</div>
                <div class="label label-service" style="left: 400px; top: 175px;">/dlar/start_sort</div>
                <div class="label label-topic" style="left: 150px; top: 320px;">/conveyor/status</div>
                <div class="label label-topic" style="left: 220px; top: 280px;">/conveyor/cmd</div>
                <div class="label label-topic" style="left: 450px; top: 270px;">/dlar/system_status</div>
                <div class="label label-service" style="left: 350px; top: 310px;">/dlar/restart_system</div>

                <!-- Integration Message -->
                <div class="integration-msg">
                    <i class="fas fa-check-circle mr-2"></i>
                    모든 컴포넌트가 ROS2 Topic/Service로 통합됨 - 표준 미들웨어 아키텍처
                </div>
            </div>

            <!-- Legend -->
            <div class="legend">
                <div class="legend-title"><i class="fas fa-list mr-2"></i>범례</div>
                
                <div class="legend-section">
                    <h4>노드 유형</h4>
                    <div class="legend-item"><div class="legend-color" style="background: #ef4444;"></div>Driver (DSR)</div>
                    <div class="legend-item"><div class="legend-color" style="background: #22c55e;"></div>App Node</div>
                    <div class="legend-item"><div class="legend-color" style="background: #3b82f6;"></div>Interface Node</div>
                    <div class="legend-item"><div class="legend-color" style="background: #8b5cf6;"></div>Watcher</div>
                    <div class="legend-item"><div class="legend-color" style="background: #f59e0b;"></div>External</div>
                </div>

                <div class="legend-section">
                    <h4>통신 방식</h4>
                    <div class="legend-item"><div class="legend-line topic"></div>Topic (Pub/Sub)</div>
                    <div class="legend-item"><div class="legend-line service"></div>Service (Req/Res)</div>
                </div>

                <div class="legend-section">
                    <h4>주요 토픽</h4>
                    <div style="font-size: 9px; color: #94a3b8; line-height: 1.6;">
                        /dsr01/joint_states<br>
                        /dlar/status<br>
                        /dlar/recovery_status<br>
                        /conveyor/status<br>
                        /conveyor/cmd<br>
                        /dlar/system_status
                    </div>
                </div>

                <div class="legend-section">
                    <h4>주요 서비스</h4>
                    <div style="font-size: 9px; color: #94a3b8; line-height: 1.6;">
                        /dlar/start_sort<br>
                        /dlar/conveyor_mode<br>
                        /dlar/collision_recovery<br>
                        /dsr01/motion/move_*<br>
                        /dsr01/system/get_robot_state
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
</body>
</html>
